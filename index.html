<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XRise VR Platform</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script>
    // Player movement and jump script
    AFRAME.registerComponent('player-controller', {
      init: function () {
        this.velocity = new THREE.Vector3(0, 0, 0);
        this.jumping = false;
        this.jumpCooldown = false;
        this.jumpStrength = 0.2;
        this.gravity = -0.01;

        document.addEventListener('keydown', (e) => {
          const key = e.key.toLowerCase();
          if (key === ' ') this.jump();
        });
      },
      tick: function (time, delta) {
        const el = this.el;
        const velocity = this.velocity;
        const position = el.object3D.position;

        // Apply gravity if jumping
        if (this.jumping) {
          velocity.y += this.gravity;
          position.y += velocity.y;

          // Stop jumping when back on the ground
          if (position.y <= 0.5) {
            this.jumping = false;
            position.y = 0.5;
            velocity.y = 0;
          }
        }

        el.object3D.position.copy(position);
      },
      jump: function () {
        if (this.jumping || this.jumpCooldown) return;
        this.jumping = true;
        this.velocity.y = this.jumpStrength;

        // Add a cooldown to prevent spam-jumping
        this.jumpCooldown = true;
        setTimeout(() => (this.jumpCooldown = false), 500);
      },
    });

    // Collectible interaction script
    AFRAME.registerComponent('collectible', {
      schema: {
        sound: { type: 'string', default: '' },
      },
      init: function () {
        this.el.addEventListener('mouseenter', () => {
          // Play sound
          if (this.data.sound) {
            const audio = new Audio(this.data.sound);
            audio.play();
          }

          // Remove the collectible
          this.el.parentNode.removeChild(this.el);
        });
      },
    });
  </script>
</head>
<body>
  <a-scene>
    <!-- Background and Sky -->
    <a-sky color="#88d3e3"></a-sky>

    <!-- Player -->
    <a-entity 
      id="player" 
      camera 
      position="0 0.5 0" 
      wasd-controls 
      player-controller>
    </a-entity>

    <!-- Collectibles -->
    <a-entity position="-3 0.5 -3" 
      geometry="primitive: sphere; radius: 0.3" 
      material="color: yellow" 
      collectible="sound: https://cdn.pixabay.com/download/audio/2022/10/31/audio_1ef60c8f2f.mp3">
    </a-entity>
    <a-entity position="2 0.5 -4" 
      geometry="primitive: sphere; radius: 0.3" 
      material="color: yellow" 
      collectible="sound: https://cdn.pixabay.com/download/audio/2022/10/31/audio_1ef60c8f2f.mp3">
    </a-entity>
    <a-entity position="0 0.5 -5" 
      geometry="primitive: sphere; radius: 0.3" 
      material="color: yellow" 
      collectible="sound: https://cdn.pixabay.com/download/audio/2022/10/31/audio_1ef60c8f2f.mp3">
    </a-entity>

    <!-- Ground Plane -->
    <a-plane 
      position="0 0 -4" 
      rotation="-90 0 0" 
      width="50" 
      height="50" 
      color="#00FF00">
    </a-plane>

    <!-- 3D Objects (Environment) -->
    <a-cylinder position="2 0.75 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
    <a-sphere position="1.5 2 -3.5" radius="0.5" color="#4CC3D9"></a-sphere>
    <a-cylinder position="-5 0.75 -10" radius="0.2" height="3" color="#8B4513"></a-cylinder>
    <a-sphere position="-5 3 -10" radius="1" color="#228B22"></a-sphere>
    <a-cylinder position="5 0.75 -10" radius="0.2" height="3" color="#8B4513"></a-cylinder>
    <a-sphere position="5 3 -10" radius="1" color="#228B22"></a-sphere>

    <!-- Footer -->
    <a-entity position="0 -1 -4">
      <a-text 
        value="Â© 2024 XRise Platform - All Rights Reserved" 
        align="center" 
        color="#ffffff" 
        width="3">
      </a-text>
    </a-entity>
  </a-scene>
</body>
</html>
